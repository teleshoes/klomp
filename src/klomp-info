#!/usr/bin/perl
use strict;
use warnings;
use lib "/opt/klomp/lib";
use Klomp::Files;

my $atts = join "|", qw(album artist number title);

my $usage = "Usage:
  $0 [ARG ARG ARG ..]
    print args separated by spaces
    ARG is [playlist|$atts]
";

sub main(@){
  my $curFile = Klomp::Files::klompFile("cur");
  my $cur = `cat $curFile`;

  my $out = '';
  for my $arg(@ARGV){
    $out .= ' ' if $out ne '';
    if($arg eq 'playlist'){
      my $pl = `klomp-cmd playlist`;
      chomp $pl;
      $out .= "<$pl>" if $pl ne 'main';
    }elsif($arg =~ /^($atts)$/){
      $out .= $1 if $cur =~ /^$arg=(.*)$/m;
    }else{
      die "Usage: $0 [arg arg arg]\n\n";
    }
  }
  print $out;
}

&main(@ARGV);
