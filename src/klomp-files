#!/usr/bin/perl
use strict;
use warnings;
use lib "/opt/klomp/lib";
use Klomp::Files;

my $allKlompFiles = Klomp::Files::allKlompFiles();

my $okFiles = join "|", sort keys %$allKlompFiles;

my $usage = "Usage:
  $0 [OPTS] FILE [FILE FILE..]
    Print the path to each klomp-file FILE, followed by a newline

  FILE
    $okFiles

  OPTS
    -n
      do not output newline after any FILE
";

sub main(@){
  my @filePaths;

  my $sep="\n";
  for my $arg(@_){
    if(defined $$allKlompFiles{$arg}){
      push @filePaths, $$allKlompFiles{$arg};
    }elsif($arg =~ /^(-n)$/){
      $sep = "";
    }else{
      die "$usage\nERROR: unknown arg $arg\n";
    }
  }

  die $usage if @filePaths == 0;

  for my $filePath(@filePaths){
    print "$filePath$sep";
  }
}

&main(@ARGV);
